<!DOCTYPE html>
<html>

<head>
  <style>
    html,
    body,
    #map {
      padding: 0;
      margin: 0;
      width: 100%;
      height: 100%;
    }
  </style>
  <link href="../node_modules/maplibre-gl/dist/maplibre-gl.css" rel="stylesheet" />
  <script src="../node_modules/maplibre-gl/dist/maplibre-gl.js"></script>
  <!-- Maplibre ArcGIS -->
  <script src="../dist/maplibre-arcgis-debug.js"></script>

</head>

<body>
  <div id="map"></div>
  <script src="../debug/apikey.js"></script>
  <script>

    const map = new maplibregl.Map({
      container: "map", // the id of the div element
      zoom: 3, // starting zoom
      center: [-117.805, 34.027], // starting location
    });

    const basemapStyle = new maplibreArcGIS.BasemapStyle('arcgis/outdoor', {
      token: apiKey
    });

    basemapStyle.applyStyleTo(map);

    // These options are also accepted in the constructor
    map.once("render", () => {
      setTimeout(async () => {
        const newStyle = await basemapStyle.changeStyle({
          worldview: 'unitedStatesOfAmerica',
        });

        console.log('New style applied:', newStyle);

        map.setStyle(newStyle, {
          diff: true,
          validate: false
        });
      }, 3000);
    });
  </script>
</body>

</html>
