<!DOCTYPE html>
<html>
    <head>
        <style>
            html, body, #map {
                padding:0;
                margin:0;
                width:100%;
                height:100%;
            }
        </style>
        <link href="../node_modules/maplibre-gl/dist/maplibre-gl.css" rel="stylesheet"/>
        <script src="../node_modules/maplibre-gl/dist/maplibre-gl.js"></script>
        <!-- Maplibre ArcGIS -->
        <script src="../dist/maplibre-arcgis-debug.js"></script>

    </head>
    <body>
        <div id="map"></div>
        <script src="../debug/apikey.js"></script>
        <script type="module">

            const basemapsKey = apiKey;
            const vectorTileKey = vectorTileApiKey;

            const map = new maplibregl.Map({
                container: "map", // the id of the div element
                zoom: 12, // starting zoom
                center: [-118.805, 34.027], // starting location [longitude, latitude]
            });
            const style = new maplibreArcGIS.BasemapStyle('arcgis/light-gray', {
                accessToken: basemapsKey
            });
            style.applyStyleTo(map);
            
            map.on('load', async () => {
                const vectorLayer = await maplibreArcGIS.VectorTileLayer.fromItemId('f0298e881b5b4743bbdf2c7d378acc84');

                map.addSource(vectorLayer.sourceId,vectorLayer.source);

                map.addLayer({
                    ...vectorLayer.layer, // This includes properties like source, source-layer, and zoom/extent information
                    type:'fill',
                    id:'custom-fill',
                    paint:{
                        "fill-color": ['case',
                            ['==', ['get','UseType'], 'Residential'], '#E8E191', // Yellow
                            ['==', ['get','UseType'], 'Commercial'], '#E580A2', // Red
                            ['==', ['get','UseType'], 'Government'], '#79E284', // Green
                            ['==', ['get','UseType'], 'Industrial'], '#C080E5', // Purple
                            ['==', ['get','UseType'], 'Institutional'], '#80BBE5', // Blue
                            '#bfbfbf'
                        ]
                    }
                });
                map.addLayer({
                    ...vectorLayer.layer,
                    type:'line',
                    id:'custom-outline',
                    paint:{
                        'line-color':'#000000',
                        'line-width':0.25,
                        'line-opacity':0.25
                    }
                });
            });
        </script>
    </body>
</html>